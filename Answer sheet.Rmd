---
title: "Answer/solution sheet"
output: 
  html_document:
    toc: TRUE
    df_print: paged
    number_sections: FALSE
    highlight: tango
    theme: lumen
    toc_depth: 3
    toc_float: true
    css: custom.css 
    self_contained: false
    includes:
      after_body: footer.html
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

install.packages("devtools")
devtools::install_github("hadley/emo")
```
***
# Let's go through it together one by one `r emo::ji(':blush:')`

## 1a. Load the data.table package and the nycflights13. Below you will see the assigning codes as the nycflights13 package consists of several datasets. Before running the code, write code that converts each dataset to data.table:
```{r}

library(data.table)
library(nycflights13)

airports_data <- data.table(airports)
flights_data <- data.table(flights)
planes_data <- data.table(planes)
```


## 1b. Select rows 40 to 95 from flights_data:


```{r}
flights_data [40:95]

```


## 2a. Select all rows from flights_data that have an air time lower than 100, then rename air_time to flight_time by using the chaining operation and return it as a list:


```{r}
flights_data[(air_time) <100][, .(flight_time = air_time)]

```


## 2b. From which origin where the most destination and arrival time of flights in flights_data? Return the answer as data.table (you might want to deal with the na-s from now :))


```{r}
clean_flights_data <- na.omit(flights_data)
clean_flights_data[, .N, by = .(dest, arr_time)][order(-N)]

```


## 3a. Add a new column calculating the average air_time for the flights from each origin:


```{r}
clean_flights_data[, mean(air_time), by = .(origin)]

```


## 3b. Using the %inbetween% operation, in planes_data check which manifacturer produces planes with a number of seats between 50-100, and then calculate the average of the seats these planes have: 


```{r}
planes_data[seats %between% c(50, 100), mean(seats), by = .(manufacturer)]

```


## 4a. Find how many flights arrived on time / how many flights had the same arrival time as the scheduled one?


```{r}

clean_flights_data[, (sum(arr_time == sched_arr_time))]

```


## 4b.Find the most frequent departure time from the carriers in flights_data (careful with na-s!):


```{r}
frequent_dep<-clean_flights_data[, .N, by = .(carrier, dep_time)][order(N, decreasing = TRUE)]

```


## 4c.Using .SD, find which carrier had the longest airtime at flights_data:


```{r}
clean_flights_data[ , .SD[which.max(air_time)], by = carrier][order(-air_time)]
```

